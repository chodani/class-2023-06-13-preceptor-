---
title: "Economic Connectedness"
author: "Daniel Cho"
format: html
execute:
  echo: false

---


```{r}
#| message: false
library(tidyverse)
```

```{r}
#| message: false
x <- read_csv("data/social_capital_county.csv", show_col_types = FALSE)

x |>
  select(county_name, pop2018, ec_county) |>
  mutate(state = substring(county_name, first = regexpr(", ", county_name)+1)) |>
  group_by(state) |>
  summarize(state_population = sum(pop2018, na.rm = TRUE), avg_county_pop = mean(ec_county, na.rm = TRUE)) |>
  ggplot(aes(x = state_population, y = avg_county_pop)) +
  scale_x_continuous(trans = "log10", breaks = c(1000000, 10000000), labels = scales::comma) + 
  geom_point() + geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Economic Connectedness and Population in US States", 
       subtitle = "Bigger states have counties with lower average economic connectedness",
       x = "State Population", y = "Average County Economic Connectedness")
```
```{r}

```

